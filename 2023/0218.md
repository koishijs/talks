---
theme: seriph
class: text-center
highlighter: shiki
background: /local/100717603_p0.png
---

# Koishi Talk

<div class="opacity-80">
35th / 2023-2-18
</div>

---
layout: center
---

# 开源机器人生态的困境

---

# NoneBot 的生态如何？

<br/>

- https://github.com/HibiKier/zhenxun_bot
- https://github.com/Ice-Cirno/HoshinoBot
- https://github.com/CMHopeSunshine/LittlePaimon
- https://github.com/SK-415/HarukaBot
- https://github.com/Kyomotoi/ATRI

---

# 那么实际上呢？

<br/>

<v-clicks>

- 大型 bot 会形成自己的生态圈
- 不同生态圈之间形成了壁垒，相互难以交换
- 每个 bot 有着不同的搭建方法，很难同时运行每一个
- 每个 bot 有着不同的使用方法，就算同时安装多个也会缺乏一致性
- 用户搭建的成品机器人总是有类似的功能，用户不能发挥创造性

</v-clicks>

---

# 生态壁垒是如何形成的？

<br/>

<v-clicks>

- 生态壁垒：子生态中的贡献本可以却难以作用于主生态用户
- 如果不受约束，开源生态一定会向着坏的方向发展
- 大型 bot 的开发者倾向于在自己侧完成修改（即便本不需要由自己完成），增加了许多重复性
- 仓库逻辑复杂，开发者要提供大量功能才能获得竞争力，所以会更加倾向于贡献和修改现有的仓库，从而加剧生态壁垒；一旦某个 bot 不维护了，庞大的 codebase 会立即导致大量难民
- 小型生态可以中心化管理；越大的生态，官方的影响力越低，割裂的现象越严重

</v-clicks>

---
layout: center
---

# Koishi 的正交性设计

---

# 我们的目标

<br/>

<v-clicks>

- 我们需要构建能够快速发展的生态
- 我们需要降低开发者的心智负担，释放更多的产能
- 我们需要优化用户的使用体验，解放用户的创造性
- 答案是正交性设计

</v-clicks>

---

# 什么是正交性？

<br/>

<v-clicks>

- 功能由多个维度构成，彼此独立
- 每个维度只影响最终效果的某个方面（aspect）
- 不同的维度交给不同的插件负责
- 举例：
  - 我们有 rate-limit 负责速率限制，有 admin 负责权限管理，有 locales 负责文本替换，有 commands 负责指令的别名，有过滤器负责功能开关
  - 大型成品机器人都有这些需求，如果不采用正交性设计：
    - 效率降低，并增加了迁移成本
    - 想象一下每个插件都提供不同名称的配置项来负责 rate-limit、locales、aliases……

</v-clicks>

---

# 这些功能是必要的吗？

<br/>

<v-clicks>

- 一些常见的对 Koishi 的质疑：
  - 沙盒不是必要的，在真实平台体验更好
  - 更新插件时应该停服是非常合理的，本来就不应该在运行时更新
  - 插件作者本来就没有考虑这么多，正交性设计反而增加了开发者的心智负担
- 我想回复他们：从来如此，便对么？
- 用户实际上并不清楚自己的需求，许多需求其实是产品创造的
- 当你把正交性设计摆到用户面前时，你才会发现它真正解放了用户的创造性
  - 用户第一次有了脱离大型成品机器人来塑造设定的能力
  - 用户第一次拥有了从生态中自己挑选并组装机器人的体验

</v-clicks>

---
layout: center
---

# Koishi 的开发理念

---
layout: center
---

要给 Koishi 目前的成就用一个词概括的话是______。

---
layout: center
---

无论你认为 Koishi 的如今是好是坏，要给 Koishi 目前的成就用一个词概括的话那只能是效率。

---

# 为什么要提高效率？

<br/>

<v-clicks>

- 正交性设计需要规模化来分担开发成本
- 效率×人口即是产能，要想快速规模化必须提高产能
- 好的生态必须通过官方引导，而官方产能决定了对生态的影响力

</v-clicks>

---

# Koishi 的效率高吗？

<br/>

<v-clicks>

- Koishi 在相同时间内产出了更多特性
- Koishi 官方团队在人手不足的情况下实际引导了更大的社区力量
- 在过去的一个月内 Koishi 增加了 100 个插件
- 优秀的开发者能在 1 周内写出 blockly 这样的插件
- 有了快速迭代的能力，我们能够在未来把握更多的机遇

</v-clicks>

---

# Koishi 有哪些效率？

<br/>

- 热重载：极致的开发效率
- 沙盒：极致的测试效率
- 工作区：极致的分发效率（构建，发布，二次开发）
- 插件市场：极致的更新迭代效率
- K-on：极致的上手效率

---

# Koishi 的版本规划

<br>

- 多想，慢做，少说
- 有稳定适中的发版频率：每周一个 patch 版本，每两个月一个 minor 版本
- Koishi 本体不发 major，所有破坏性变更全部交给插件完成

---
layout: center
---

# The End
